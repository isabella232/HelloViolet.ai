---
layout: docs
title: 'JSDoc: Class: ConversationEngine'
---


  <h1 class="page-title">Class: ConversationEngine</h1>


<div id="generatedNav" style="display:none">
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-conversationEngine.html">conversationEngine</a></li><li><a href="module-flowScriptCompiler.html">flowScriptCompiler</a></li><li><a href="module-outputMgr.html">outputMgr</a></li><li><a href="module-response.html">response</a></li><li><a href="module-scriptParser.html">scriptParser</a></li><li><a href="module-utils.html">utils</a></li><li><a href="module-violet.html">violet</a></li><li><a href="module-violetList.html">violetList</a></li><li><a href="module-violetSrvr.html">violetSrvr</a></li><li><a href="module-violetStorePG.html">violetStorePG</a></li><li><a href="module-violetStoreSF.html">violetStoreSF</a></li><li><a href="module-violetTime.html">violetTime</a></li></ul><h3>Classes</h3><ul><li><a href="AlexaPlatform.html">AlexaPlatform</a></li><li><a href="module-conversationEngine-ConversationEngine.html">ConversationEngine</a></li><li><a href="module-conversationEngine-IntentMgr.html">IntentMgr</a></li><li><a href="module-conversationEngine-PlatformMgr.html">PlatformMgr</a></li><li><a href="module-conversationEngine-PlatformPlugin.html">PlatformPlugin</a></li><li><a href="module-conversationEngine-PlatformReq.html">PlatformReq</a></li><li><a href="module-flowScriptCompiler-FlowScriptCompiler.html">FlowScriptCompiler</a></li><li><a href="module-outputMgr-OutputMgr.html">OutputMgr</a></li><li><a href="module-response-Response.html">Response</a></li><li><a href="module-scriptParser-ScriptParser.html">ScriptParser</a></li><li><a href="module-violetList-ListWidget.html">ListWidget</a></li><li><a href="module-violetList-listWidget_.html">listWidget</a></li><li><a href="module-violetStorePG-VioletStorePG.html">VioletStorePG</a></li><li><a href="module-violetStoreSF-VioletStoreSF.html">VioletStoreSF</a></li><li><a href="StorePlugin.html">StorePlugin</a></li></ul><h3>Events</h3><ul><li><a href="global.html#event:(unnamed)">(unnamed)</a></li><li><a href="module-conversationEngine.html#~event:closeSession">closeSession</a></li><li><a href="global.html#event:Howdy">Howdy</a></li><li><a href="global.html#event:HowWork">HowWork</a></li><li><a href="global.html#event:Intro">Intro</a></li><li><a href="global.html#event:MajorIntent">MajorIntent</a></li><li><a href="global.html#event:setAlert">setAlert</a></li><li><a href="module-violetTime.html#~event:timeFwd">timeFwd</a></li><li><a href="module-violetTime.html#~event:timeReq">timeReq</a></li><li><a href="global.html#event:unsetAlert">unsetAlert</a></li><li><a href="global.html#event:WakeUp">WakeUp</a></li></ul>
</div>

<div class="codeDocs">
{% raw %}





<section>

<header>
    
        <h2><span class="attribs"><span class="type-signature"></span></span>
            <span class="ancestors"><a href="module-conversationEngine.html">conversationEngine</a>~</span>ConversationEngine<span class="signature">()</span><span class="type-signature"></span></h2>
        
            <div class="class-description">The primary class for scripts to use to define how they
<a href="module-conversationEngine-ConversationEngine.html#respondTo">respond to</a>
users (intents) and how
<a href="module-conversationEngine-ConversationEngine.html#defineGoal">goals behave</a>
behave when triggered by the script.
<br><br>
This class is helped by the ScriptParser to build a model of the users
script, the IntentMgr to process data from the Platforms and call intents in Scripts,
and the OutputMgr to take calls from Scripts via the Response class and
build an output for sending back to the Platforms.</div>
        
    
</header>

<article>
    <div class="container-overview">
    
        

    
    <h2>Constructor</h2>
    

    
    <h4 class="name" id="ConversationEngine"><span class="type-signature"></span>new ConversationEngine<span class="signature">()</span><span class="type-signature"></span></h4>
    

    



<div class="description">
    Constructed and returned by Violet when a Voice Script initializes
</div>













<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="violet-conversations_lib_conversationEngine.js.html">violet-conversations/lib/conversationEngine.js</a>, <a href="violet-conversations_lib_conversationEngine.js.html#line440">line 440</a>
    </li></ul></dd>
    

    

    

    
</dl>


















    
    </div>

    

    

    

    

    

    

    

    
        <h3 class="subsection-title">Methods</h3>

        
            

    

    
    <h4 class="name" id="addInputTypes"><span class="type-signature"></span>addInputTypes<span class="signature">(inputTypes)</span><span class="type-signature"></span></h4>
    

    



<div class="description">
    Used to define parameters that can be expected from the user
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>inputTypes</code></td>
            

            <td class="type">
            
                
<span class="param-type">Object</span>


            
            </td>

            

            

            <td class="description last">key:value pairs representing varName:typeName.
   Commonly supported values for typeName are: firstName, lastName, number,
   date, time, phoneNumber, and phrase. In addition, typeName can be an
   object for customSlots (with a values property) or for AMAZON.LITERAL
   (with a sampleValues property)</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="violet-conversations_lib_conversationEngine.js.html">violet-conversations/lib/conversationEngine.js</a>, <a href="violet-conversations_lib_conversationEngine.js.html#line765">line 765</a>
    </li></ul></dd>
    

    

    

    
</dl>

















    <h5>Examples</h5>
    
        <p class="code-caption">basic usage</p>
    
    <pre class="prettyprint"><code>violet.addInputTypes({
  'name': 'firstName',
});

violet.respondTo(['My name is [[name]]'],
 (response) => {
   response.say('I like the name [[name]]')
 });</code></pre>

        <p class="code-caption">defining custom types</p>
    
    <pre class="prettyprint"><code>violet.addInputTypes({
  'timeUnit': {
    type: 'timeUnitType',
    values: ['days', 'hours', 'minutes']
  }
});</code></pre>

        <p class="code-caption">defining literals (while literals are open ended, it is recommended to use custom types for better recognition)</p>
    
    <pre class="prettyprint"><code>violet.addInputTypes({
  'itemName': {
    type: 'AMAZON.LITERAL',
    sampleValues: ['Call Chris', 'Book an appointment']
  }
});</code></pre>



        
            

    

    
    <h4 class="name" id="addPhraseEquivalents"><span class="type-signature"></span>addPhraseEquivalents<span class="signature">()</span><span class="type-signature"></span></h4>
    

    



<div class="description">
    Gives a set of equivalent phrases
</div>













<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="violet-conversations_lib_conversationEngine.js.html">violet-conversations/lib/conversationEngine.js</a>, <a href="violet-conversations_lib_conversationEngine.js.html#line782">line 782</a>
    </li></ul></dd>
    

    

    

    
</dl>

















    <h5>Example</h5>
    
    <pre class="prettyprint"><code>violet.addPhraseEquivalents([
  ['My name is', 'I call myself'],
]);
violet.respondTo(['My name is [[name]]'],
  (response) => {
    response.say('I like the name [[name]]')
  });</code></pre>



        
            

    

    
    <h4 class="name" id="defineGoal"><span class="type-signature"></span>defineGoal<span class="signature">(goalDef)</span><span class="type-signature"></span></h4>
    

    



<div class="description">
    Defines what should happen when a goal is triggered (by calling the
<a href="module-response-Response.html#addGoal">addGoal</a> method). Goals allow for
the grouping of application and user responses.
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>goalDef</code></td>
            

            <td class="type">
            
                
<span class="param-type">Object</span>


            
            </td>

            

            

            <td class="description last">goal definition
                <h6>Properties</h6>
                

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>goal</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last">name of the goal</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>resolve</code></td>
            

            <td class="type">
            
                
<span class="param-type">resolveCallback</span>


            
            </td>

            

            

            <td class="description last">callback when the goal is triggered (required unless prompt or ask have been provided)</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>prompt</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last">string to prompt the user (usually for information) when the goal has been triggered</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>ask</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last">similar to prompt, except that user can be prompted multiple items, but asked only one question at a time</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>respondTo</code></td>
            

            <td class="type">
            
                
<span class="param-type">Array.&lt;Object></span>


            
            </td>

            

            

            <td class="description last">array of intents than can be triggered only after this goal has been triggered - for details see the <a href="module-conversationEngine-ConversationEngine.html#respondTo">respondTo</a> method (required if prompt or ask have been provided)</td>
        </tr>

    
    </tbody>
</table>

            </td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="violet-conversations_lib_conversationEngine.js.html">violet-conversations/lib/conversationEngine.js</a>, <a href="violet-conversations_lib_conversationEngine.js.html#line860">line 860</a>
    </li></ul></dd>
    

    

    

    
</dl>

















    <h5>Examples</h5>
    
        <p class="code-caption">setting up goals to be triggered from a regular intent</p>
    
    <pre class="prettyprint"><code>violet.respondTo('What time does the [[airline]] flight arrive',
  (response) => {
    response.addGoal('flightArrivalTime');
});
violet.respondTo('What time does the flight arrive from [[city]]',
  (response) => {
    response.addGoal('flightArrivalTime');
});</code></pre>

        <p class="code-caption">when the user is asking for a flight arrival time and we want to check if dependencies have been provided</p>
    
    <pre class="prettyprint"><code>violet.defineGoal({
  goal: 'flightArrivalTime',
  resolve: (response) => {
    if (!response.ensureGoalFilled('airline')
        || !response.ensureGoalFilled('city')
        || !response.ensureGoalFilled('flightDay') ) {
          return false; // dependent goals not met
        }
    var airline = response.get('airline');
    var city = response.get('city');
    var flightDay = response.get('flightDay');
    flightArrivalTimeSvc.query(airline, city, flightDay, (arrivalTime)=>{
      response.say('Flight ' + airline + ' from ' + city + ' is expected to arrive ' + flightDay + ' at ' + arrivalTime);
    });
    return true;
  }
});</code></pre>

        <p class="code-caption">when the user is asking for a flight arrival time and has not provided the airline name</p>
    
    <pre class="prettyprint"><code>violet.defineGoal({
  goal: 'airline',
  prompt: ['What airline', 'What airlines are you looking for the arrival time?'],
  respondTo: [{
    expecting: '[[airline]]',
    resolve: (response) => {
      response.set('airline', response.get('airline') );
  }}]
});</code></pre>

        <p class="code-caption">when the user is asking for a flight arrival time and has not provided the originating city</p>
    
    <pre class="prettyprint"><code>violet.defineGoal({
  goal: 'city',
  prompt: ['What city do you want the flight to be arriving from'],
  respondTo: [{
    expecting: '[[city]]',
    resolve: (response) => {
      response.set('city', response.get('city') );
  }}]
});</code></pre>



        
            

    

    
    <h4 class="name" id="registerResponseDecorator"><span class="type-signature"></span>registerResponseDecorator<span class="signature">()</span><span class="type-signature"></span></h4>
    

    



<div class="description">
    Called by some Violet plugins (such as the store plugins) to decorate the Response
class when instantiated. The initResponse method on these objects are called
with the Response object as a parameter and are expected to return the decorated
response object.
</div>













<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="violet-conversations_lib_conversationEngine.js.html">violet-conversations/lib/conversationEngine.js</a>, <a href="violet-conversations_lib_conversationEngine.js.html#line963">line 963</a>
    </li></ul></dd>
    

    

    

    
</dl>


















        
            

    

    
    <h4 class="name" id="respondTo"><span class="type-signature"></span>respondTo<span class="signature">(intentDef)</span><span class="type-signature"></span></h4>
    

    



<div class="description">
    Declare how you are going to be responding to users
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>intentDef</code></td>
            

            <td class="type">
            
                
<span class="param-type">Object</span>


            
            </td>

            

            

            <td class="description last">intent definition
                <h6>Properties</h6>
                

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>expecting</code></td>
            

            <td class="type">
            
                
<span class="param-type">Array.&lt;string></span>


            
            </td>

            

            

            <td class="description last">array of strings that a user could say</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>resolve</code></td>
            

            <td class="type">
            
                
<span class="param-type">resolveCallback</span>


            
            </td>

            

            

            <td class="description last">callback when one of the `expecting` items is said</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>goal</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last">(optional) when provided above is applied only during given goal</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>name</code></td>
            

            <td class="type">
            
                
<span class="param-type">Array.&lt;string></span>


            
            </td>

            

            

            <td class="description last">(optional) when provided is used as the intent name (otherwise one is generated)</td>
        </tr>

    
    </tbody>
</table>

            </td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="violet-conversations_lib_conversationEngine.js.html">violet-conversations/lib/conversationEngine.js</a>, <a href="violet-conversations_lib_conversationEngine.js.html#line923">line 923</a>
    </li></ul></dd>
    

    

    

    
</dl>

















    <h5>Examples</h5>
    
        <p class="code-caption">a basic example</p>
    
    <pre class="prettyprint"><code>violet.respondTo('Hello',
 (response) => {
   response.say('Hi');
 });</code></pre>

        <p class="code-caption">using most of the parameters</p>
    
    <pre class="prettyprint"><code>violet.respondTo({
   expecting: ['I live in [[city]]', 'My house is in [[city]]', 'We are renting in [[city]]'],
   resolve: (response) => {
    response.say('I like the city [[city]]')
}});</code></pre>



        
            

    

    
    <h4 class="name" id="setCloseRequests"><span class="type-signature"></span>setCloseRequests<span class="signature">(phrases)</span><span class="type-signature"></span></h4>
    

    



<div class="description">
    Override the default phrases to close the session.
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>phrases</code></td>
            

            <td class="type">
            
                
<span class="param-type">Array.&lt;string></span>


            
            </td>

            

            

            <td class="description last">response or array of potential responses</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="violet-conversations_lib_conversationEngine.js.html">violet-conversations/lib/conversationEngine.js</a>, <a href="violet-conversations_lib_conversationEngine.js.html#line645">line 645</a>
    </li></ul></dd>
    

    

    

    
</dl>


















        
            

    

    
    <h4 class="name" id="setLaunchPhrases"><span class="type-signature"></span>setLaunchPhrases<span class="signature">(phrases)</span><span class="type-signature"></span></h4>
    

    



<div class="description">
    Override the default launch phrases. Parameter is used directly
with the response.say() function when a Platform launches this app
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>phrases</code></td>
            

            <td class="type">
            
                
<span class="param-type">Array.&lt;string></span>


            
            </td>

            

            

            <td class="description last">response or array of potential responses</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="violet-conversations_lib_conversationEngine.js.html">violet-conversations/lib/conversationEngine.js</a>, <a href="violet-conversations_lib_conversationEngine.js.html#line636">line 636</a>
    </li></ul></dd>
    

    

    

    
</dl>


















        
    

    

    
</article>

</section>




{% endraw %}
</div>


<footer class="container">
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> on Thu Aug 15 2019 22:21:30 GMT-0400 (EDT)
</footer>

<script> /*prettyPrint();*/ </script>
<!-- script src="scripts/linenumber.js"> </script -->
<script>
  // prism-ize: add language type and line-numbers
  var codeEntries = document.getElementsByTagName('pre');
  for (var ndx=0; ndx<codeEntries.length; ndx++) {
    var node = codeEntries[ndx];
    if (node.children.length!=1 && node.children[0].tagName!='CODE') continue;
    if (!node.className.match(/lang/)) node.className += ' language-javascript'
    if (node.className.match(/linenums/)) node.className += ' line-numbers'
  }
  // changes '<h3 class="subsection-title">Events</h3>'==><h3 class="subsection-title">Intents</h3>
  var headingEntries = document.getElementsByTagName('h3');
  for (var ndx=0; ndx<headingEntries.length; ndx++) {
    var node = headingEntries[ndx];
    if (node.className !== 'subsection-title') continue;
    if (node.textContent == 'Events') node.textContent = 'Intents';
  }
</script>